<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>Installing Software Using a PowerShell RightScript</title><meta content="Steps for installing software on a Windows Server using a PowerShell RightScript in the RightScale Cloud Management Platform." name="description" /><meta content="initial-scale=1" name="viewport" /><link href="https://my.rightscale.com/favicon.ico" rel="icon" /><!--Stylesheets--><link href="../../css/main.css" rel="stylesheet" /><!--JavaScript--><script src="../../js/main.js"></script></head><body class="cm cm_windows_guide cm_windows_guide_installing_software_using_a_powershell_rightscript" data-spy="scroll" data-target="#subnav-right"><nav class="navbar navbar-default navbar-fixed-top" role="navigation"><div class="container-fluid max-width"><div class="navbar-header"><button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/"><img src="../../img/FX_Logo_pos.png" /></a></div><div class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right"><li><a target="_blank" href="https://community.flexera.com/t5/Flexera-Community/ct-p/Flexera_Community">Community</a></li><li><a target="_blank" href="https://www.flexera.com/blog/">Blog</a></li><li><a target="_blank" href="https://www.flexera.com/about-us/contact-us.html">Contact</a></li><li><a target="_blank" href="https://login.rightscale.com/login/session/new">Log In</a></li></ul><ul class="nav navbar-nav navbar-right nav-status"><li class="nav-al-search"><a href="../../search.html">Search</a></li></ul><form class="navbar-form navbar-left" role="search" action="/search.html" method="get" ><div class="form-group"><input class="form-control input-sm" id="site-search" placeholder="Search" type="text" name="q" /></div><input type="submit" style="position: absolute; left: -9999px"/></form><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script type="text/javascript"> docsearch({apiKey: 'b58c3ad6ab9d6e3cd425867d64a6766f',indexName: 'rightscale',inputSelector: '#site-search', debug: false, autocompleteOptions: {autoselect: false}});</script></div></div></nav><div class="wrap"><div class="container-fluid max-width"><div class="row"><div class="col-sm-3"><div class="clearfix"><aside class="main-nav" role="complementary"><nav class="list-group" role="navigations"><a class="list-group-item" href="/cm"><h4 class="list-group-heading"><img src="../../img/product-cloud-management.svg" /><span>Cloud Management</span></h4></a><a class="list-group-item" href="../about.html">About</a><a class="list-group-item" href="/cm/rs101/">Terminology and Concepts</a><a class="list-group-item" href="/cm/management_guide/">Lifecycle Management</a><a class="list-group-item" href="/cm/dashboard/">Dashboard User's Guide</a><a class="list-group-item" href="/cm/administrators_guide/">Administrator's Guide</a><a class="list-group-item" href="/cm/designers_guide/">Designer's Guide</a><a class="list-group-item" href="/cm/dashboard/design/server_templates/">ServerTemplates</a><a class="list-group-item" href="/cm/servertemplate_dev_guide/">ServerTemplate Developer's Guide</a><a class="list-group-item" href="/cm/pas/">Publishing and Sharing</a><a class="list-group-item" href="/cm/windows_guide/">Windows Guide</a><a class="list-group-item" href="/cm/ref/">Reference Information</a></nav></aside><div class="callout"><a href="/api/"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../img/icon-api.svg" /><h4>Flexera CMP APIs</h4></div><span>See the API reference documentation for all of our products.</span></div></div></a></div><div class="callout"><a href="../../ca/cloud_comp/ca_getting_started_with_cloud_comparison.html"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../img/icon-cloud-blue.svg" /><h4>Cloud Comparison</h4></div><span>Compare public clouds based on the features they offer.</span></div></div></a></div><div class="callout"><a target="_blank" href="http://feedback.rightscale.com"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../img/icon-feedback.svg" /><h4>Feedback</h4></div><span>Get in touch and we’ll get back to you as soon as we can.</span></div></div></a></div><div class="callout"><a href="/release-notes"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../img/icon-notes.svg" /><h4>Release Notes</h4></div><span>See the notes for the latest releases of each application and what’s changed.</span></div></div></a></div></div></div><div class="col-sm-9"><div class="row"><div class="col-sm-9"><div class="clearfix"><p><a href="../../">Flexera CMP Docs</a> &#x2F; <a href="../">Cloud Management</a> &#x2F; <a href="./">Windows Guide</a></p><div class="page-header"><h1>Installing Software Using a PowerShell RightScript</h1></div><div class="main-content"><h2 id="overview">Overview</h2>

<p>A common use case for Windows users is need to install various pieces of software on a running Windows Server. The aim of the tutorial is to use PowerShell to install Firefox as an example. This will help to draw attention to the individual steps and also the different PowerShell constructs involved.</p>

<p>Before you begin you may wish to RDP into your running Windows server so you can see the installation activity as you run the scripts. In particular, if you open Windows Explorer you should see new directories being created under &#39;C:\Program Files(x86)&#39;.</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>This tutorial assumes you have a running Windows Server, and access to the software installation files. If you do not have a Windows server running, you could launch one using the &#39;Base ServerTemplate for Windows&#39; ServerTemplate from the Marketplace.</p>

<h2 id="steps">Steps</h2>

<h3 id="steps-create-the-firefox-install-rightscript">Create the Firefox Install RightScript</h3>

<p>To install the software on the server we will create a RightScript and attach to it the relevant installation files. When we run the script these installation files will be copied over onto the server. If you have never created a RightScript before, see <a href="/cm/dashboard/design/rightscripts/rightscripts_actions.html#create-a-new-rightscript">Create a New RightScript</a>.</p>

<p>Download the Firefox Installer (<a href="https://s3-us-west-2.amazonaws.com/rs-docs-assets/Firefox+Setup+41.0.2.exe">Firefox_Setup_42.0.2</a>) and the INI file (<a href="https://s3-us-west-2.amazonaws.com/rs-docs-assets/firefox_quiet_install.ini">firefox_quiet_install.ini</a>) locally to your PC. You will attach these to your RightScript a little later.</p>

<ol>
<li><p>To create the RightScript, navigate to <strong>Design</strong> &gt; <strong>RightScripts</strong>. Click <strong>New</strong>, and enter the name and description for your installation RightScript. Copy the following and paste it into the Script area:</p>
<pre class="syntax-highlight plaintext"><code># Windows powershell RightScript to install Firefox browser

#stop and fail script when a command fails
$errorActionPreference="Stop"

if (${env:programfiles(x86)})
  { $firefox_path = join-path "${env:programfiles(x86)}" "Mozilla Firefox" }
else
  { $firefox_path = join-path "${env:programfiles}" "Mozilla Firefox" }

if (test-path $firefox_path)
{
   Write-Output "Firefox already installed. Skipping script"
   exit 0
}

cmd /c "$env:RS_ATTACH_DIR\Firefox Setup 41.0.2.exe" /INI="$env:RS_ATTACH_DIR\firefox_quiet_install.ini"

#Permanently update Windows Path
if (Test-Path $firefox_path)
{
  [environment]::SetEnvironmentvariable("Path", $env:path+";"+$firefox_path, "Machine")
} Else {
  Write-Error "Failed to install FireFox. Aborting."
  exit 1
}
</code></pre></li>
<li><p>Click <strong>Save</strong>.</p></li>
<li><p>Click the script&#39;s <strong>Attachments</strong> tab, and upload the following files that you downloaded to your local machine earlier.</p>

<ul>
<li><strong>Firefox Setup 41.0.2</strong> - Firefox Installer</li>
<li><strong>firefox_quiet_install.ini</strong> - INI file</li>
</ul></li>
</ol>

<h3 id="steps-run-the-script-on-the-server">Run the Script on the Server</h3>

<ol>
<li>Navigate to <strong>Manage</strong> &gt; <strong>Instances &amp; Servers</strong> and filter for Running Instances.</li>
<li>Click your running Windows server and select the Scripts tab. Expand the &#39;Any Script&#39; section and click the <strong>Select a Script to Run</strong> button.</li>
<li>Click &#39;Unpublished&#39;, click on your new script in the RightScripts column, click the <strong>Select</strong> button, then click the <strong>Run</strong> button.</li>
</ol>

<p>Wait for the script to complete before going to the next step.</p>

<h3 id="steps-rdp-into-the-server">RDP into the Server</h3>

<ol>
<li>To verify the successful installation of Firefox, RDP into the Windows Server. <em>Note</em>: TCP port 3389 must be open in the server&#39;s security group.</li>
<li>Use the RDP server button or use your preferred RDP client with the public IP of the server. You should see Firefox as successfully installed under <strong>Start</strong> &gt; <strong>All Programs</strong> &gt; <strong>Mozilla Firefox</strong>.</li>
</ol>

<p><img src="/img/cm-firefox-installed.png" alt="cm-firefox-installed.png" width="538" height="342" /></p>

<h2 id="post-tutorial-steps">Post Tutorial Steps</h2>

<p>Once completed, remember to shut down the server (if no longer required) in order not to incur any unnecessary charges.</p>

<h2 id="further-reading">Further Reading</h2>

<ul>
<li><a href="/faq/How_do_I_install_Ruby_or_Python_for_Windows_servers_and_instances.html">How do I install Ruby or Python for Windows servers and instances?</a></li>
<li><a href="/faq/How_do_I_run_Ruby_or_Python_scripts_on_Windows_servers.html">How do I run Ruby or Python scripts on Windows Servers?</a></li>
</ul>
</div></div></div><div class="col-sm-3 hidden-xs affix-parent"><div class="clearfix" data-clampedwidth=".affix-parent" data-offset-bottom="200" data-offset-top="4" data-spy="affix"><nav class="subnav-right" id="subnav-right" role="sub-nav"><script>createRightHandNav();</script></nav></div></div></div></div></div></div></div><footer class="main-footer" role="contentinfo"><div class="container-fluid max-width"><div class="row"><div class="col-sm-10"><ul class="list-inline"><li><small>&copy; 2024 Flexera</small></li><li><a href="http://www.flexera.com/" target="_blank"><small>Flexera Home</small></a></li><li><a href="https://www.flexera.com/about-us/careers.html" target="_blank"><small>We're Hiring</small></a></li></ul></div></div></div></footer><noscript><iframe height="0" src="//www.googletagmanager.com/ns.html?id=GTM-KB9SMN" style="display:none;visibility:hidden" width="0"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-KB9SMN');</script><script type="text/javascript">
  // Add clipboard button trigger
  var snippets = document.querySelectorAll('.syntax-highlight');
  [].forEach.call(snippets, function(snippet) {
  snippet.firstChild.insertAdjacentHTML('beforebegin', '<button class="btn snippet-clipboard" data-clipboard-snippet><img src="/img/icon-clipboard.svg"></button>');
  });

  // clipboard trigger
  var clipboardSnippets = new Clipboard('[data-clipboard-snippet]', {
  target: function(trigger) {
  return trigger.nextElementSibling;
  }
  });

  // Tooltip trigger
  clipboardSnippets.on('success', function(e) {
  e.clearSelection();
  showTooltip(e.trigger, 'Copied!');
  });

  // Error message
  clipboardSnippets.on('error', function(e) {
  showTooltip(e.trigger, fallbackMessage(e.action));
  });

  // Tooltip events
  var btns = document.querySelectorAll('.syntax-highlight .btn');
  for (var i = 0; i < btns.length; i++) {
  btns[i].addEventListener('mouseleave', clearTooltip);
  btns[i].addEventListener('blur', clearTooltip);
  }

  function clearTooltip(e) {
  e.currentTarget.setAttribute('class', 'btn');
  e.currentTarget.removeAttribute('aria-label');
  }

  function showTooltip(elem, msg) {
  elem.setAttribute('class', 'btn tooltipped tooltipped-s');
  elem.setAttribute('aria-label', msg);
  }
</script></body></html>