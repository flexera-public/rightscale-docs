<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>Planned Volume Management</title><meta content="Guidelines for planning storage volume management in the RightScale Cloud Management Platform." name="description" /><meta content="initial-scale=1" name="viewport" /><link href="https://my.rightscale.com/favicon.ico" rel="icon" /><!--Stylesheets--><link href="../../css/main.css" rel="stylesheet" /><!--JavaScript--><script src="../../js/main.js"></script></head><body class="cm cm_windows_guide cm_windows_guide_planned_volume_management" data-spy="scroll" data-target="#subnav-right"><nav class="navbar navbar-default navbar-fixed-top" role="navigation"><div class="container-fluid max-width"><div class="navbar-header"><button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/"><img src="../../img/FX_Logo_pos.png" /></a></div><div class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right"><li><a target="_blank" href="https://community.flexera.com/t5/Flexera-Community/ct-p/Flexera_Community">Community</a></li><li><a target="_blank" href="https://www.flexera.com/blog/">Blog</a></li><li><a target="_blank" href="https://www.flexera.com/about-us/contact-us.html">Contact</a></li><li><a target="_blank" href="https://login.rightscale.com/login/session/new">Log In</a></li></ul><ul class="nav navbar-nav navbar-right nav-status"><li class="nav-al-search"><a href="../../search.html">Search</a></li></ul><form class="navbar-form navbar-left" role="search" action="/search.html" method="get" ><div class="form-group"><input class="form-control input-sm" id="site-search" placeholder="Search" type="text" name="q" /></div><input type="submit" style="position: absolute; left: -9999px"/></form><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script type="text/javascript"> docsearch({apiKey: 'b58c3ad6ab9d6e3cd425867d64a6766f',indexName: 'rightscale',inputSelector: '#site-search', debug: false, autocompleteOptions: {autoselect: false}});</script></div></div></nav><div class="wrap"><div class="container-fluid max-width"><div class="row"><div class="col-sm-3"><div class="clearfix"><aside class="main-nav" role="complementary"><nav class="list-group" role="navigations"><a class="list-group-item" href="/cm"><h4 class="list-group-heading"><img src="../../img/product-cloud-management.svg" /><span>Cloud Management</span></h4></a><a class="list-group-item" href="../about.html">About</a><a class="list-group-item" href="/cm/rs101/">Terminology and Concepts</a><a class="list-group-item" href="/cm/management_guide/">Lifecycle Management</a><a class="list-group-item" href="/cm/dashboard/">Dashboard User's Guide</a><a class="list-group-item" href="/cm/administrators_guide/">Administrator's Guide</a><a class="list-group-item" href="/cm/designers_guide/">Designer's Guide</a><a class="list-group-item" href="/cm/dashboard/design/server_templates/">ServerTemplates</a><a class="list-group-item" href="/cm/servertemplate_dev_guide/">ServerTemplate Developer's Guide</a><a class="list-group-item" href="/cm/pas/">Publishing and Sharing</a><a class="list-group-item" href="/cm/windows_guide/">Windows Guide</a><a class="list-group-item" href="/cm/ref/">Reference Information</a></nav></aside><div class="callout"><a href="/api/"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../img/icon-api.svg" /><h4>Flexera CMP APIs</h4></div><span>See the API reference documentation for all of our products.</span></div></div></a></div><div class="callout"><a href="../../ca/cloud_comp/ca_getting_started_with_cloud_comparison.html"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../img/icon-cloud-blue.svg" /><h4>Cloud Comparison</h4></div><span>Compare public clouds based on the features they offer.</span></div></div></a></div><div class="callout"><a target="_blank" href="http://feedback.rightscale.com"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../img/icon-feedback.svg" /><h4>Feedback</h4></div><span>Get in touch and we’ll get back to you as soon as we can.</span></div></div></a></div><div class="callout"><a href="/release-notes"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../img/icon-notes.svg" /><h4>Release Notes</h4></div><span>See the notes for the latest releases of each application and what’s changed.</span></div></div></a></div></div></div><div class="col-sm-9"><div class="row"><div class="col-sm-9"><div class="clearfix"><p><a href="../../">Flexera CMP Docs</a> &#x2F; <a href="../">Cloud Management</a> &#x2F; <a href="./">Windows Guide</a></p><div class="page-header"><h1>Planned Volume Management</h1></div><div class="main-content"><h2 id="overview">Overview</h2>

<p>Before RightLink Windows instances run boot scripts, they sometimes perform an extra step known as planned volume management. This step is only performed when running in Amazon EC2; it is designed to compensate for some shortcomings of EBS when used with Windows.</p>

<h2 id="problem-statement">Problem Statement</h2>

<p>Amazon EBS was designed for use with Linux, whose I/O subsystem uses named files such as <strong>/dev/sdk</strong> to represent physical hardware devices. The virtualization-aware block device drivers built into the Linux kernel ensure a consistent mapping between the an EBS volume and its corresponding virtual disk device. The instance boots with a <q>disk</q> already attached, and can mount the partitions of that disk whenever it&#39;s convenient to do so.</p>

<p>In contrast, the Windows I/O subsystem uses numbered devices; numbers are assigned to disks in the approximate order in which they are discovered during kernel initialization. Although EC2 allows callers to specify pseudo-device names such as <strong>xvdd</strong> when attaching a volume, there is no way for a virtualization-agnostic Windows kernel to ensure a consistent mapping between the EBS volume, a particular disk number, and an eventual drive letter when the disk is mounted.</p>

<p>Furthermore, Windows does not automatically mount volumes on boot unless they contain a valid NTFS partition; blank volumes remain uninitialized until the user takes some action.</p>

<h2 id="ensuring-consistent-volume-mappings-with-rightlink">Ensuring Consistent Volume Mappings with RightLink</h2>

<p>To support reusable RightScripts, the RightLink agent performs planned volume management when it detects that it is running on Windows in EC2. Planned volume management consists of the following steps, which happen the first time the instance boots:</p>

<ol>
<li>Detach every EBS volume that is already attached.</li>
<li>Enumerate all of the volumes that <em>were</em> attached, and their device names (<strong>xvdd</strong>, <strong>xvde</strong>, and so forth).</li>
<li>Proceeding in device-name order, reattach each volume; wait for a Windows disk device to appear; partition and format the disk, if necessary; and mount it with the designated drive letter.</li>
</ol>

<p>The result of planned volume management is that RightLink-managed Windows instances behave like their Linux counterparts and your RightScripts can be authored using only drive letters with no concern for device numbers or partition/format readiness.</p>

<h2 id="shortcomings-of-planned-volume-management">Shortcomings of Planned Volume Management</h2>

<p>This feature is designed to accommodate the most basic use case for EBS: individual disks containing non-striped volumes that are used to store persistent data across server relaunches.</p>

<p>More advanced users may have other purposes in mind for EBS. Some examples:</p>

<ul>
<li>Using an EBS volume stripe as a high-throughput scratch disk</li>
<li>Coordinated backup and restore of an EBS stripe</li>
<li>Advanced <a href="http://en.wikipedia.org/wiki/Logical_volume_management">LVM</a> functionality that requires EBS volumes to be partitioned in a non-standard way</li>
</ul>

<p>In these cases, boot RightScripts must work directly with the Windows I/O subsystem; planned volume management does not always add value, and can add a significant delay to the Windows boot sequence.</p>

<h2 id="disabling-planned-volume-management">Disabling Planned Volume Management</h2>

<p><em>Note</em>: The following functionality is supported in all versions of RightLink.</p>

<p>If you are designing a ServerTemplate that performs its own volume management, it may be advantageous to disable RightScale&#39;s volume management. To do this, simply add the following tag to your ServerTemplate so that it will be inherited by any servers and/or server arrays that are built with the template:</p>

<p><strong>rs_storage:manage=false</strong></p>

<p>This instructs the RightScale dashboard not to perform any planned volume management. An audit entry will appear in the Windows boot sequence, but no devices will be detached, attached, partitioned or formatted. The volumes will be left in their initial state and your boot scripts can manage them as required.</p>

<p>If the tag is present on your ServerTemplate and has any value <em>other</em> than <strong>false</strong>, then volume management will still be performed.</p>
</div></div></div><div class="col-sm-3 hidden-xs affix-parent"><div class="clearfix" data-clampedwidth=".affix-parent" data-offset-bottom="200" data-offset-top="4" data-spy="affix"><nav class="subnav-right" id="subnav-right" role="sub-nav"><script>createRightHandNav();</script></nav></div></div></div></div></div></div></div><footer class="main-footer" role="contentinfo"><div class="container-fluid max-width"><div class="row"><div class="col-sm-10"><ul class="list-inline"><li><small>&copy; 2024 Flexera</small></li><li><a href="http://www.flexera.com/" target="_blank"><small>Flexera Home</small></a></li><li><a href="https://www.flexera.com/about-us/careers.html" target="_blank"><small>We're Hiring</small></a></li></ul></div></div></div></footer><noscript><iframe height="0" src="//www.googletagmanager.com/ns.html?id=GTM-KB9SMN" style="display:none;visibility:hidden" width="0"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-KB9SMN');</script><script type="text/javascript">
  // Add clipboard button trigger
  var snippets = document.querySelectorAll('.syntax-highlight');
  [].forEach.call(snippets, function(snippet) {
  snippet.firstChild.insertAdjacentHTML('beforebegin', '<button class="btn snippet-clipboard" data-clipboard-snippet><img src="/img/icon-clipboard.svg"></button>');
  });

  // clipboard trigger
  var clipboardSnippets = new Clipboard('[data-clipboard-snippet]', {
  target: function(trigger) {
  return trigger.nextElementSibling;
  }
  });

  // Tooltip trigger
  clipboardSnippets.on('success', function(e) {
  e.clearSelection();
  showTooltip(e.trigger, 'Copied!');
  });

  // Error message
  clipboardSnippets.on('error', function(e) {
  showTooltip(e.trigger, fallbackMessage(e.action));
  });

  // Tooltip events
  var btns = document.querySelectorAll('.syntax-highlight .btn');
  for (var i = 0; i < btns.length; i++) {
  btns[i].addEventListener('mouseleave', clearTooltip);
  btns[i].addEventListener('blur', clearTooltip);
  }

  function clearTooltip(e) {
  e.currentTarget.setAttribute('class', 'btn');
  e.currentTarget.removeAttribute('aria-label');
  }

  function showTooltip(elem, msg) {
  elem.setAttribute('class', 'btn tooltipped tooltipped-s');
  elem.setAttribute('aria-label', msg);
  }
</script></body></html>