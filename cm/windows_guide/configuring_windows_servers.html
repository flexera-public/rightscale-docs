<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>Configuring Windows Servers</title><meta content="Notes on configuring Windows Servers in RightScale including creating ServerTemplates and using RightScripts and Chef." name="description" /><meta content="initial-scale=1" name="viewport" /><link href="https://my.rightscale.com/favicon.ico" rel="icon" /><!--Stylesheets--><link href="../../css/main.css" rel="stylesheet" /><!--JavaScript--><script src="../../js/main.js"></script></head><body class="cm cm_windows_guide cm_windows_guide_configuring_windows_servers" data-spy="scroll" data-target="#subnav-right"><nav class="navbar navbar-default navbar-fixed-top" role="navigation"><div class="container-fluid max-width"><div class="navbar-header"><button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/"><img src="../../img/FX_Logo_pos.png" /></a></div><div class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right"><li><a target="_blank" href="https://community.flexera.com/t5/Flexera-Community/ct-p/Flexera_Community">Community</a></li><li><a target="_blank" href="https://www.flexera.com/blog/">Blog</a></li><li><a target="_blank" href="https://www.flexera.com/about-us/contact-us.html">Contact</a></li><li><a target="_blank" href="https://login.rightscale.com/login/session/new">Log In</a></li></ul><ul class="nav navbar-nav navbar-right nav-status"><li class="nav-al-search"><a href="../../search.html">Search</a></li></ul><form class="navbar-form navbar-left" role="search" action="/search.html" method="get" ><div class="form-group"><input class="form-control input-sm" id="site-search" placeholder="Search" type="text" name="q" /></div><input type="submit" style="position: absolute; left: -9999px"/></form><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script type="text/javascript"> docsearch({apiKey: 'b58c3ad6ab9d6e3cd425867d64a6766f',indexName: 'rightscale',inputSelector: '#site-search', debug: false, autocompleteOptions: {autoselect: false}});</script></div></div></nav><div class="wrap"><div class="container-fluid max-width"><div class="row"><div class="col-sm-3"><div class="clearfix"><aside class="main-nav" role="complementary"><nav class="list-group" role="navigations"><a class="list-group-item" href="/cm"><h4 class="list-group-heading"><img src="../../img/product-cloud-management.svg" /><span>Cloud Management</span></h4></a><a class="list-group-item" href="../about.html">About</a><a class="list-group-item" href="/cm/rs101/">Terminology and Concepts</a><a class="list-group-item" href="/cm/management_guide/">Lifecycle Management</a><a class="list-group-item" href="/cm/dashboard/">Dashboard User's Guide</a><a class="list-group-item" href="/cm/administrators_guide/">Administrator's Guide</a><a class="list-group-item" href="/cm/designers_guide/">Designer's Guide</a><a class="list-group-item" href="/cm/dashboard/design/server_templates/">ServerTemplates</a><a class="list-group-item" href="/cm/servertemplate_dev_guide/">ServerTemplate Developer's Guide</a><a class="list-group-item" href="/cm/pas/">Publishing and Sharing</a><a class="list-group-item" href="/cm/windows_guide/">Windows Guide</a><a class="list-group-item" href="/cm/ref/">Reference Information</a></nav></aside><div class="callout"><a href="/api/"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../img/icon-api.svg" /><h4>Flexera CMP APIs</h4></div><span>See the API reference documentation for all of our products.</span></div></div></a></div><div class="callout"><a href="../../ca/cloud_comp/ca_getting_started_with_cloud_comparison.html"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../img/icon-cloud-blue.svg" /><h4>Cloud Comparison</h4></div><span>Compare public clouds based on the features they offer.</span></div></div></a></div><div class="callout"><a target="_blank" href="http://feedback.rightscale.com"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../img/icon-feedback.svg" /><h4>Feedback</h4></div><span>Get in touch and we’ll get back to you as soon as we can.</span></div></div></a></div><div class="callout"><a href="/release-notes"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../img/icon-notes.svg" /><h4>Release Notes</h4></div><span>See the notes for the latest releases of each application and what’s changed.</span></div></div></a></div></div></div><div class="col-sm-9"><div class="row"><div class="col-sm-9"><div class="clearfix"><p><a href="../../">Flexera CMP Docs</a> &#x2F; <a href="../">Cloud Management</a> &#x2F; <a href="./">Windows Guide</a></p><div class="page-header"><h1>Configuring Windows Servers</h1></div><div class="main-content"><h2 id="creating-windows-servertemplates">Creating Windows ServerTemplates</h2>

<p>All ServerTemplates are built the same way. See <a href="/cm/dashboard/design/server_templates/servertemplates.html">ServerTemplates</a>. In order to build a Windows ServerTemplate you will need to use a MultiCloud Image that references a Windows-based RightImage.</p>

<h2 id="using-rightscripts">Using RightScripts</h2>

<p>Powershell is the main scripting language used in the Windows environment, and as such is used for both RightScripts and Chef recipes. Chef is just another layer in front of the Powershell scripts.</p>

<h2 id="note-on-decommission-state">Note on Decommission State</h2>

<p>Windows server instances follow the new &#39;decommissioning&#39; phase for v5 RightImages where the decommissioning scripts are explicitly executed in a brief timeframe (up to 180 seconds) before a request is made to Amazon to terminate the instance. See <a href="/cm/management_guide/server_states.html">Server States</a> for more information.</p>

<p>On rare occasions, a server instance can get stuck in the decommissioning phase while running the sequence of decommission scripts. As a consequence, a request to terminate the instance has not been sent to Amazon. If your Windows server instance becomes stranded in the decommissioning phase, you will need to manually terminate the instance (Clouds &gt; [AWS Region] &gt; EC2 Instances), which will send a termination request directly to Amazon and force the instance to be shut down.</p>

<p>RightScale is currently in the process of improving the shutdown process in order to prevent a server instance from getting stranded in the decommissioning phase.</p>

<h2 id="using-chef-on-windows-based-servers">Using Chef on Windows-Based Servers</h2>

<p>While the principles behind <a href="http://support.rightscale.com/12-Guides/Chef_Cookbooks_Developer_Guide/index.html">Chef</a> remain the same across both Linux/Windows platforms, using Chef on Windows means using different Chef providers. Developing Chef providers on Windows also presents unique challenges as Ruby is not as pervasive and does not give access to critical functionality that many Chef providers may require.</p>

<h3 id="using-chef-on-windows-based-servers-available-chef-providers">Available Chef Providers</h3>

<p>RightScale&#39;s Windows RightImages provide access to the following Chef Providers:</p>

<ul>
<li>Powershell, HttpRequest, RubyBlock: fully functional.</li>
<li>File, Directory, Template, RemoteFile, RemoteDirectory: these providers are all functional however the owner and group attributes are not supported.</li>
<li>Execute, Script, Ruby: these providers are all functional however the following command arguments are ignored: timeout, user, group and umask.</li>
<li>Perl, Python: same as above, also Perl and/or Python must be installed and in the path.</li>
</ul>

<p>In addition to the Chef providers listed above, <a href="/rl10/about.html">RightLink</a> on Windows allows you to write your own Chef providers all in Powershell. See <a href="http://support.rightscale.com/12-Guides/Chef_Cookbooks_Developer_Guide/04-Developer/06-Development_Resources/Powershell_Chef_Providers/index.html">Powershell Chef Providers</a>.</p>

<h3 id="using-chef-on-windows-based-servers-examples">Examples</h3>

<p>Be sure to check out our public repository for some working examples of PowerShell scripts: <a href="http://github.com/rightscale/cookbooks_public_windows/tree/master/cookbooks/">http://github.com/rightscale/cookbooks_public_windows/tree/master/cookbooks/</a></p>
</div></div></div><div class="col-sm-3 hidden-xs affix-parent"><div class="clearfix" data-clampedwidth=".affix-parent" data-offset-bottom="200" data-offset-top="4" data-spy="affix"><nav class="subnav-right" id="subnav-right" role="sub-nav"><script>createRightHandNav();</script></nav></div></div></div></div></div></div></div><footer class="main-footer" role="contentinfo"><div class="container-fluid max-width"><div class="row"><div class="col-sm-10"><ul class="list-inline"><li><small>&copy; 2024 Flexera</small></li><li><a href="http://www.flexera.com/" target="_blank"><small>Flexera Home</small></a></li><li><a href="https://www.flexera.com/about-us/careers.html" target="_blank"><small>We're Hiring</small></a></li></ul></div></div></div></footer><noscript><iframe height="0" src="//www.googletagmanager.com/ns.html?id=GTM-KB9SMN" style="display:none;visibility:hidden" width="0"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-KB9SMN');</script><script type="text/javascript">
  // Add clipboard button trigger
  var snippets = document.querySelectorAll('.syntax-highlight');
  [].forEach.call(snippets, function(snippet) {
  snippet.firstChild.insertAdjacentHTML('beforebegin', '<button class="btn snippet-clipboard" data-clipboard-snippet><img src="/img/icon-clipboard.svg"></button>');
  });

  // clipboard trigger
  var clipboardSnippets = new Clipboard('[data-clipboard-snippet]', {
  target: function(trigger) {
  return trigger.nextElementSibling;
  }
  });

  // Tooltip trigger
  clipboardSnippets.on('success', function(e) {
  e.clearSelection();
  showTooltip(e.trigger, 'Copied!');
  });

  // Error message
  clipboardSnippets.on('error', function(e) {
  showTooltip(e.trigger, fallbackMessage(e.action));
  });

  // Tooltip events
  var btns = document.querySelectorAll('.syntax-highlight .btn');
  for (var i = 0; i < btns.length; i++) {
  btns[i].addEventListener('mouseleave', clearTooltip);
  btns[i].addEventListener('blur', clearTooltip);
  }

  function clearTooltip(e) {
  e.currentTarget.setAttribute('class', 'btn');
  e.currentTarget.removeAttribute('aria-label');
  }

  function showTooltip(elem, msg) {
  elem.setAttribute('class', 'btn tooltipped tooltipped-s');
  elem.setAttribute('aria-label', msg);
  }
</script></body></html>