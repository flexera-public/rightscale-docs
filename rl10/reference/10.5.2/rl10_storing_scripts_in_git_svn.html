<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>Storing Scripts in Git, Subversion, or other VCS</title><meta content="RightLink 10 RightScripts can be stored in a Git or SVN version control system instead of in the Design > RightScripts section of the RightScale Cloud Management Dashboard." name="description" /><meta content="initial-scale=1" name="viewport" /><meta content="10" name="docsearch:version_major" /><meta content="5" name="docsearch:version_minor" /><meta content="2" name="docsearch:version_patch" /><link href="https://my.rightscale.com/favicon.ico" rel="icon" /><!--Stylesheets--><link href="../../../css/main.css" rel="stylesheet" /><!--JavaScript--><script src="../../../js/main.js"></script></head><body class="rl10 rl10_reference rl10_reference_10" data-spy="scroll" data-target="#subnav-right"><nav class="navbar navbar-default navbar-fixed-top" role="navigation"><div class="container-fluid max-width"><div class="navbar-header"><button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/"><img src="../../../img/FX_Logo_pos.png" /></a></div><div class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right"><li><a target="_blank" href="https://community.flexera.com/t5/Flexera-Community/ct-p/Flexera_Community">Community</a></li><li><a target="_blank" href="https://www.flexera.com/blog/">Blog</a></li><li><a target="_blank" href="https://www.flexera.com/about-us/contact-us.html">Contact</a></li><li><a target="_blank" href="https://login.rightscale.com/login/session/new">Log In</a></li></ul><ul class="nav navbar-nav navbar-right nav-status"><li class="nav-al-search"><a href="../../../search.html">Search</a></li></ul><form class="navbar-form navbar-left" role="search" action="/search.html" method="get" ><div class="form-group"><input class="form-control input-sm" id="site-search" placeholder="Search" type="text" name="q" /></div><input type="submit" style="position: absolute; left: -9999px"/></form><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script type="text/javascript"> docsearch({apiKey: 'b58c3ad6ab9d6e3cd425867d64a6766f',indexName: 'rightscale',inputSelector: '#site-search', debug: false, autocompleteOptions: {autoselect: false}});</script></div></div></nav><div class="wrap"><div class="container-fluid max-width"><div class="row"><div class="col-sm-3"><div class="clearfix"><aside class="main-nav" role="complementary"><nav class="list-group" role="navigations"><a class="list-group-item" href="/rl10"><h4 class="list-group-heading"><span>RightLink 10</span></h4></a><a class="list-group-item" href="../../about.html">About</a><a class="list-group-item" href="../../getting_started.html">Getting Started</a><a class="list-group-item" href="../../os_use_case_cloud_support.html">Operating System,<br> Use Case, and Cloud Support</a><a class="list-group-item" href="/rl10/reference">Reference</a><a class="list-group-item" href="/rl10/releases">Releases</a><a class="list-group-item" href="/rl10/tools">Tools</a><a class="list-group-item" href="/rl10/migration">Migration Guide</a></nav></aside><div class="callout"><a href="/api/"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../../img/icon-api.svg" /><h4>Flexera CMP APIs</h4></div><span>See the API reference documentation for all of our products.</span></div></div></a></div><div class="callout"><a href="../../../ca/cloud_comp/ca_getting_started_with_cloud_comparison.html"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../../img/icon-cloud-blue.svg" /><h4>Cloud Comparison</h4></div><span>Compare public clouds based on the features they offer.</span></div></div></a></div><div class="callout"><a target="_blank" href="http://feedback.rightscale.com"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../../img/icon-feedback.svg" /><h4>Feedback</h4></div><span>Get in touch and we’ll get back to you as soon as we can.</span></div></div></a></div><div class="callout"><a href="/release-notes"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../../img/icon-notes.svg" /><h4>Release Notes</h4></div><span>See the notes for the latest releases of each application and what’s changed.</span></div></div></a></div></div></div><div class="col-sm-9"><div class="row"><div class="col-sm-9"><div class="clearfix"><p><a href="../../../">Flexera CMP Docs</a> &#x2F; <a href="../../">RightLink 10</a> &#x2F; <a href="../">Reference</a> &#x2F; <a href="./">Reference</a></p><div class="pull-right"><div class="btn-group"><a aria-haspopup="true" class="btn btn-success dropdown-toggle" data-toggle="dropdown" id="version-dropdown" type="button"><strong>Version:</strong>&nbsp;<span>10.5.2&nbsp;</span><span class="caret"></span></a><ul class="dropdown-menu" role="menu"><li><a href="/rl10/reference/10.6.4/rl10_storing_scripts_in_git_svn.html">10.6.4</a></li><li><a href="/rl10/reference/10.6.3/rl10_storing_scripts_in_git_svn.html">10.6.3</a></li><li><a href="/rl10/reference/10.6.2/rl10_storing_scripts_in_git_svn.html">10.6.2</a></li><li><a href="/rl10/reference/10.6.1/rl10_storing_scripts_in_git_svn.html">10.6.1</a></li><li><a href="/rl10/reference/10.6.0/rl10_storing_scripts_in_git_svn.html">10.6.0</a></li><li><a href="/rl10/reference/10.5.3/rl10_storing_scripts_in_git_svn.html">10.5.3</a></li><li><a href="/rl10/reference/10.5.2/rl10_storing_scripts_in_git_svn.html">10.5.2</a></li><li><a href="/rl10/reference/10.5.1/rl10_storing_scripts_in_git_svn.html">10.5.1</a></li></ul></div></div><div class="page-header"><h1>Storing Scripts in Git, Subversion, or other VCS</h1></div><div class="main-content"><h2 id="overview">Overview</h2>

<p>In addition to just storing RightScripts and ServerTemplates in the RightScale Cloud Management system, you may wish to
store them in your own version control system such as Git or Subversion. There are two methods of achieving this:</p>

<ul>
<li>Using the <a href="https://github.com/rightscale/right_st">Right ST</a> tool to push RightScripts or whole ServerTemplates into the RightScale CM system</li>
<li>Laying out your Git or Subversion repository like a Chef cookbook and using RightScale&#39;s <q>repository fetcher</q></li>
</ul>

<p>The <a href="https://github.com/rightscale/right_st">Right ST</a> tool method is recommended because it is both simpler and more flexible.</p>

<h2 id="right-st-tool-method">Right ST Tool Method</h2>

<p><a href="https://github.com/rightscale/right_st">Right ST</a> is an open source tool maintained by RightScale&#39;s RightLink team. We provide <a href="https://github.com/rightscale/right_st#installation">pre-compiled binaries</a> for
Linux, Mac OS X, and Windows. Right ST works with scripts using <a href="/cm/dashboard/design/rightscripts/rightscripts_metadata_comments.html">RightScript Metadata Comments</a> and thus supports
specifying default and possible values for inputs supporting all RightScale input types. It also supports specifying
attachments in the metadata comments and will use file checksums to determine if a file needs to be uploaded to the
platform when uploading.</p>

<p>Right ST is a command line tool so it can be used directly as part of the development process, in a shell script, as
part of a post-commit hook, or in a continuous integration system such as <a href="https://travis-ci.org/">Travis CI</a>, <a href="https://www.appveyor.com/">AppVeyor</a>, or <a href="https://jenkins-ci.org/">Jenkins</a>.</p>

<h3 id="right-st-tool-method-rightscript-usage">RightScript Usage</h3>

<p>You can read about Right ST&#39;s support for RightScripts in its documentation for <a href="https://github.com/rightscale/right_st#managing-rightscripts">Managing RightScripts</a>. The RightScript
related commands are:</p>
<pre class="syntax-highlight plaintext"><code>right_st rightscript show &lt;name|href|id&gt;
  Show a single RightScript and its attachments.

right_st rightscript upload [&lt;flags&gt;] &lt;path&gt;...
  Upload a RightScript
  Flags:
    -f, --force: Force upload of RightScript despite lack of Metadata comments
    -x, --prefix: Append a prefix to RightScript's name when uploading. For
                  creating dev/test versions of scripts.

right_st rightscript download &lt;name|href|id&gt; [&lt;path&gt;]
  Download a RightScript to a file. Metadata comments will automatically be
   inserted into RightScripts that don't have it.

right_st rightscript scaffold [&lt;flags&gt;] &lt;path&gt;...
  Add RightScript YAML metadata comments to a file or files

right_st rightscript validate &lt;path&gt;...
  Validate RightScript YAML metadata comments in a file or files
</code></pre>

<h3 id="right-st-tool-method-servertemplate-usage">ServerTemplate Usage</h3>

<p>You can read about Right ST&#39;s support for ServerTemplates in its documentation for <a href="https://github.com/rightscale/right_st#managing-servertemplates">Managing ServerTemplates</a>. The
ServerTemplate related commands are:</p>
<pre class="syntax-highlight plaintext"><code>right_st st show &lt;name|href|id&gt;
  Show a single ServerTemplate

right_st st upload &lt;path&gt;...
  Upload a ServerTemplate specified by a YAML document
  Flags:
    -x, --prefix: Append a prefix to ServerTemplate and RightScript names when
                  uploading. For creating dev/test versions of ServerTemplates.

right_st st download &lt;name|href|id&gt; [&lt;path&gt;]
  Download a ServerTemplate and all associated RightScripts/Attachments to disk

right_st st validate &lt;path&gt;...
  Validate a ServerTemplate YAML document
</code></pre>

<h2 id="chef-cookbook-style-method">Chef Cookbook Style Method</h2>

<p>RightLink 10 scripts (<q>RightScripts</q>) can be stored in a Git or SVN version control system instead of in the <strong>Design &gt; RightScripts</strong> section of the RightScale Cloud Management dashboard. The implementation hijacks the machinery originally built for Chef in the RightScale platform to support placing RightScripts into git (or svn) repositories and adding them to ServerTemplates (Note that RightLink 10 does not have any built-in support for true Chef cookbooks). The mechanics for using this are:</p>

<ul>
<li>place RightScripts into a git repository accessible by the RightScale platform</li>
<li>create a metadata.rb file that describes the scripts in Chef terms so the RightScale&#39;s <q>repository fetcher</q> can index the content of the repository</li>
<li>let RightScale fetch the repository</li>
<li>drag the scripts into the ServerTemplate as if they were recipes</li>
<li>let RightLink 10 do the rest</li>
</ul>

<p>The quickest way to get started is to fork the <a href="https://github.com/rightscale/rightlink_scripts">github</a> repository that contains the scripts for the base ServerTemplate. The README.md has most of the information you need.</p>

<h3 id="chef-cookbook-style-method-repository-structure">Repository structure</h3>

<p><strong>Requirements/limitations</strong>:</p>

<ul>
<li>the repository top-level must consist of cookbook directories (other directories are allowed, top-level cookbooks are not supported)</li>
<li>each cookbook directory must have a metadata.rb file</li>
<li>each cookbook directory must have all the RightScripts at the top-level (subdirectories may contain supplementary files)</li>
<li>each RightScript must have a filename extension (such as .sh, .rb, .ps1, ...)</li>
<li>for Linux, each RightScript must contain a <q>#! /path/to/executable</q> header (note the space between ! and /)</li>
</ul>

<p><strong>Sample directory tree</strong>:</p>
<pre class="syntax-highlight plaintext"><code>  rightlink_scripts (repo)
  +- rll (cookbook)
  |   +- init.sh (recipe)
  |   +- collectd.sh (recipe)
  |   +- metadata.rb
  |   +- templates (directory)
  |       +- collectd.conf (random file)
  +- mysql (cookbook)
  |   +- metadata.rb
  |   +- install.sh (recipe)
  ...
</code></pre>

<h4 id="limitations-on-cookbook-directories">Limitations on Cookbook Directories</h4>

<ul>
<li>each cookbook directory must be stand-alone, that is, there must be no <q>../</q> type of references to <q>sister</q> cookbooks within scripts</li>
<li>each cookbook directory and subtree is downloaded in its entirety, so templates or similar files can be placed anywhere</li>
<li>all files are given read-write permissions and only recipes to be executed are given execute permissions, any additional necessary permissions must be set explicitly in a script (permissions set by checking files into git/svn are not honored)</li>
<li>RightLink 10 will add execute permissions to RightScripts just before executing them</li>
</ul>

<h3 id="chef-cookbook-style-method-script-execution-environment">Script Execution Environment</h3>

<p>(see also RightLink 10 <a href="rl10_script_execution.html">Script Execution</a>)</p>

<ul>
<li>Scripts will be executed with the current working directory (CWD) set to the cookbook&#39;s directory (i.e. also the directory where the script lives)</li>
<li>Scripts will be executed as the user that RightLink 10 runs as, typically root</li>
<li>The script&#39;s environment variables will be set to include: HOME, SHELL, USER, PATH, client_id, account, and api_hostname, http_proxy, no_proxy, plus all global environment variables set in RightLink 10, plus all arguments specified in the metadata.rb for the script/recipe. The later sources in this list override prior sources if a variable is defined multiple times.</li>
</ul>

<h4 id="metadata.rb">Metadata.rb</h4>

<ul>
<li>The metadata.rb must follow enough of the Chef conventions to <q>pass</q> the RightScale metadata scraper to produce cookbooks, recipes, and attributes in the core</li>
<li>the recipe statement must name the recipe without the filename extension (e.g. rll::init for the script called init.sh in the rll cookbook)</li>
<li>the attributes must be of type string</li>
<li>the default values may refer to environmental variables by using a value such as <code>env:RS_SKETCHY</code></li>
</ul>
</div></div></div><div class="col-sm-3 hidden-xs affix-parent"><div class="clearfix" data-clampedwidth=".affix-parent" data-offset-bottom="200" data-offset-top="4" data-spy="affix"><nav class="subnav-right" id="subnav-right" role="sub-nav"><script>createRightHandNav();</script></nav></div></div></div></div></div></div></div><footer class="main-footer" role="contentinfo"><div class="container-fluid max-width"><div class="row"><div class="col-sm-10"><ul class="list-inline"><li><small>&copy; 2024 Flexera</small></li><li><a href="http://www.flexera.com/" target="_blank"><small>Flexera Home</small></a></li><li><a href="https://www.flexera.com/about-us/careers.html" target="_blank"><small>We're Hiring</small></a></li></ul></div></div></div></footer><noscript><iframe height="0" src="//www.googletagmanager.com/ns.html?id=GTM-KB9SMN" style="display:none;visibility:hidden" width="0"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-KB9SMN');</script><script type="text/javascript">
  // Add clipboard button trigger
  var snippets = document.querySelectorAll('.syntax-highlight');
  [].forEach.call(snippets, function(snippet) {
  snippet.firstChild.insertAdjacentHTML('beforebegin', '<button class="btn snippet-clipboard" data-clipboard-snippet><img src="/img/icon-clipboard.svg"></button>');
  });

  // clipboard trigger
  var clipboardSnippets = new Clipboard('[data-clipboard-snippet]', {
  target: function(trigger) {
  return trigger.nextElementSibling;
  }
  });

  // Tooltip trigger
  clipboardSnippets.on('success', function(e) {
  e.clearSelection();
  showTooltip(e.trigger, 'Copied!');
  });

  // Error message
  clipboardSnippets.on('error', function(e) {
  showTooltip(e.trigger, fallbackMessage(e.action));
  });

  // Tooltip events
  var btns = document.querySelectorAll('.syntax-highlight .btn');
  for (var i = 0; i < btns.length; i++) {
  btns[i].addEventListener('mouseleave', clearTooltip);
  btns[i].addEventListener('blur', clearTooltip);
  }

  function clearTooltip(e) {
  e.currentTarget.setAttribute('class', 'btn');
  e.currentTarget.removeAttribute('aria-label');
  }

  function showTooltip(elem, msg) {
  elem.setAttribute('class', 'btn tooltipped tooltipped-s');
  elem.setAttribute('aria-label', msg);
  }
</script></body></html>