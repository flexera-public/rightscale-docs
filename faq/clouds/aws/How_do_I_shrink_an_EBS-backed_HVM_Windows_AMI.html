<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>How do I shrink an EBS-backed HVM Windows AMI?</title><meta content="This is a multi-step process involving some use of the AWS console, so we recommend having both the RightScale Dashboard and AWS console open in separate tabs in your browser." name="description" /><meta content="initial-scale=1" name="viewport" /><link href="https://my.rightscale.com/favicon.ico" rel="icon" /><!--Stylesheets--><link href="../../../css/main.css" rel="stylesheet" /><!--JavaScript--><script src="../../../js/main.js"></script></head><body class="faq faq_clouds faq_clouds_aws faq_clouds_aws_How_do_I_shrink_an_EBS-backed_HVM_Windows_AMI" data-spy="scroll" data-target="#subnav-right"><nav class="navbar navbar-default navbar-fixed-top" role="navigation"><div class="container-fluid max-width"><div class="navbar-header"><button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/"><img src="../../../img/FX_Logo_pos.png" /></a></div><div class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right"><li><a target="_blank" href="https://community.flexera.com/t5/Flexera-Community/ct-p/Flexera_Community">Community</a></li><li><a target="_blank" href="https://www.flexera.com/blog/">Blog</a></li><li><a target="_blank" href="https://www.flexera.com/about-us/contact-us.html">Contact</a></li><li><a target="_blank" href="https://login.rightscale.com/login/session/new">Log In</a></li></ul><ul class="nav navbar-nav navbar-right nav-status"><li class="nav-al-search"><a href="../../../search.html">Search</a></li></ul><form class="navbar-form navbar-left" role="search" action="/search.html" method="get" ><div class="form-group"><input class="form-control input-sm" id="site-search" placeholder="Search" type="text" name="q" /></div><input type="submit" style="position: absolute; left: -9999px"/></form><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script type="text/javascript"> docsearch({apiKey: 'b58c3ad6ab9d6e3cd425867d64a6766f',indexName: 'rightscale',inputSelector: '#site-search', debug: false, autocompleteOptions: {autoselect: false}});</script></div></div></nav><div class="wrap"><div class="container-fluid max-width"><div class="row"><div class="col-sm-3"><div class="clearfix"><aside class="main-nav" role="complementary"><nav class="list-group" role="navigations"><a class="list-group-item" href="/faq/"><h4 class="list-group-heading"><span>Frequently Asked Questions</span></h4></a><a class="list-group-item" href="/faq/">General</a><a class="list-group-item" href="/faq/clouds/aws">AWS</a><a class="list-group-item" href="/faq/clouds/google">Google Cloud Platform</a><a class="list-group-item" href="/faq/clouds/azure">Microsoft Azure</a><a class="list-group-item" href="/faq/clouds/softlayer">SoftLayer</a><a class="list-group-item" href="/faq/clouds/vmware">VMware</a></nav></aside><div class="callout"><a href="/api/"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../../img/icon-api.svg" /><h4>Flexera CMP APIs</h4></div><span>See the API reference documentation for all of our products.</span></div></div></a></div><div class="callout"><a href="../../../ca/cloud_comp/ca_getting_started_with_cloud_comparison.html"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../../img/icon-cloud-blue.svg" /><h4>Cloud Comparison</h4></div><span>Compare public clouds based on the features they offer.</span></div></div></a></div><div class="callout"><a target="_blank" href="http://feedback.rightscale.com"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../../img/icon-feedback.svg" /><h4>Feedback</h4></div><span>Get in touch and we’ll get back to you as soon as we can.</span></div></div></a></div><div class="callout"><a href="/release-notes"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../../../img/icon-notes.svg" /><h4>Release Notes</h4></div><span>See the notes for the latest releases of each application and what’s changed.</span></div></div></a></div></div></div><div class="col-sm-9"><div class="row"><div class="col-sm-9"><div class="clearfix"><p><a href="../../../">Flexera CMP Docs</a> &#x2F; <a href="../../">RightScale General FAQs</a> &#x2F; <a href="../">Cloud Providers</a> &#x2F; <a href="./">Amazon Web Services</a></p><div class="page-header"><h1>How do I shrink an EBS-backed HVM Windows AMI?</h1></div><div class="main-content"><h2 id="answer">Answer</h2>

<p>This is a multi-step process involving some use of the AWS console, so we recommend having both the RightScale Dashboard and AWS console open in separate tabs in your browser.</p>

<ol>
<li><p>Launch an instance directly from the image you want to resize, not using a ServerTemplate. Be sure to associate an SSH key for which you have the private key material handy.</p></li>
<li><p>Once the instance is running, retrieve the administrator password from the AWS Console. Additionally, identify the snapshot ID of the volume used as the root device by clicking the device name (typically /dev/sda1) in the description of the instance in the AWS Console.</p></li>
<li><p>Create a volume from the image you wish to resize using the snapshot ID obtained in the previous step, and attach this to the instance.</p></li>
<li><p>Create and attach a blank EBS volume using the desired size of the shrunk image.</p></li>
<li><p>Open an RDP session to the instance.</p></li>
<li><p>Open the Server Manager, and under the Server Summary section, scroll to Security Information. Click the Configure IE ESC setting; disable for admin. Now, go to Storage, enable the attached disk containing the image (right-click and set to online), then format and mark as active the empty disk(this should be e:).</p></li>
<li><p>To proceed, you&#39;ll need to install imagex. You can get the full WAIK suite from Microsoft, or selectively download the required tools using this application: <a href="http://theoven.org/index.php?topic=287">http://theoven.org/index.php?topic=287</a></p></li>
<li><p>Open the command prompt and cd to waik_3, as installed in the previous step.</p></li>
<li><p>Invoke imagex as follows, where C: is the root device, D: is the volume containing the image to be shrunk, and E: is the empty volume.</p>
<pre class="syntax-highlight plaintext"><code>imagex.exe /capture d:\ c:\server-image.wim "Windows Server Image"

imagex.exe /apply c:\server-image.wim 1 e:
</code></pre></li>
<li><p>Close your RDP session, and stop the instance from the AWS Console.</p></li>
<li><p>Detach all volumes; reattach the smaller volume as <code>/dev/sda1</code>; the other two volumes (the original root device and the volume containing the source of the image) should be destroyed.</p></li>
<li><p>(Optional) Start the instance to confirm the new image is operational; use the EC2 tools to run sysprep and stop the instance. Otherwise, skip to the next step.</p></li>
<li><p>In the AWS console, register the image using Create Image (EBS AMI).</p></li>
<li><p>Clone the source MCI in rightscale, and replace the AMI(s) with your newly registered AMI(s).</p></li>
</ol>

<h3 id="answer-see-also">See also</h3>

<ul>
<li><a href="http://support.rightscale.com/09-Clouds/AWS/FAQs/How_do_I_shrink_an_EBS-backed_HVM_Windows_AMI%3F">How do I shrink an EBS-backed HVM Windows AMI?</a></li>
<li><a href="http://support.rightscale.com/Site_Map/Site_Map_-_Alphabetic_Index">Site Map - Alphabetic Index</a></li>
<li><a href="http://support.rightscale.com/09-Clouds/AWS/Z_AWS_Site_Map">AWS Site Map</a></li>
</ul>
</div></div></div><div class="col-sm-3 hidden-xs affix-parent"><div class="clearfix" data-clampedwidth=".affix-parent" data-offset-bottom="200" data-offset-top="4" data-spy="affix"><nav class="subnav-right" id="subnav-right" role="sub-nav"><script>createRightHandNav();</script></nav></div></div></div></div></div></div></div><footer class="main-footer" role="contentinfo"><div class="container-fluid max-width"><div class="row"><div class="col-sm-10"><ul class="list-inline"><li><small>&copy; 2024 Flexera</small></li><li><a href="http://www.flexera.com/" target="_blank"><small>Flexera Home</small></a></li><li><a href="https://www.flexera.com/about-us/careers.html" target="_blank"><small>We're Hiring</small></a></li></ul></div></div></div></footer><noscript><iframe height="0" src="//www.googletagmanager.com/ns.html?id=GTM-KB9SMN" style="display:none;visibility:hidden" width="0"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-KB9SMN');</script><script type="text/javascript">
  // Add clipboard button trigger
  var snippets = document.querySelectorAll('.syntax-highlight');
  [].forEach.call(snippets, function(snippet) {
  snippet.firstChild.insertAdjacentHTML('beforebegin', '<button class="btn snippet-clipboard" data-clipboard-snippet><img src="/img/icon-clipboard.svg"></button>');
  });

  // clipboard trigger
  var clipboardSnippets = new Clipboard('[data-clipboard-snippet]', {
  target: function(trigger) {
  return trigger.nextElementSibling;
  }
  });

  // Tooltip trigger
  clipboardSnippets.on('success', function(e) {
  e.clearSelection();
  showTooltip(e.trigger, 'Copied!');
  });

  // Error message
  clipboardSnippets.on('error', function(e) {
  showTooltip(e.trigger, fallbackMessage(e.action));
  });

  // Tooltip events
  var btns = document.querySelectorAll('.syntax-highlight .btn');
  for (var i = 0; i < btns.length; i++) {
  btns[i].addEventListener('mouseleave', clearTooltip);
  btns[i].addEventListener('blur', clearTooltip);
  }

  function clearTooltip(e) {
  e.currentTarget.setAttribute('class', 'btn');
  e.currentTarget.removeAttribute('aria-label');
  }

  function showTooltip(elem, msg) {
  elem.setAttribute('class', 'btn tooltipped tooltipped-s');
  elem.setAttribute('aria-label', msg);
  }
</script></body></html>