<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>MySQL Performance Tuning Tips</title><meta content="Performance testing is both art and science and finding the right combination of performance parameters needs some trial and error." name="description" /><meta content="initial-scale=1" name="viewport" /><link href="https://my.rightscale.com/favicon.ico" rel="icon" /><!--Stylesheets--><link href="../css/main.css" rel="stylesheet" /><!--JavaScript--><script src="../js/main.js"></script></head><body class="faq faq_MySQL_Performance_Tuning_Tips" data-spy="scroll" data-target="#subnav-right"><nav class="navbar navbar-default navbar-fixed-top" role="navigation"><div class="container-fluid max-width"><div class="navbar-header"><button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/"><img src="../img/FX_Logo_pos.png" /></a></div><div class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right"><li><a target="_blank" href="https://community.flexera.com/t5/Flexera-Community/ct-p/Flexera_Community">Community</a></li><li><a target="_blank" href="https://www.flexera.com/blog/">Blog</a></li><li><a target="_blank" href="https://www.flexera.com/about-us/contact-us.html">Contact</a></li><li><a target="_blank" href="https://login.rightscale.com/login/session/new">Log In</a></li></ul><ul class="nav navbar-nav navbar-right nav-status"><li class="nav-al-search"><a href="../search.html">Search</a></li></ul><form class="navbar-form navbar-left" role="search" action="/search.html" method="get" ><div class="form-group"><input class="form-control input-sm" id="site-search" placeholder="Search" type="text" name="q" /></div><input type="submit" style="position: absolute; left: -9999px"/></form><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script type="text/javascript"> docsearch({apiKey: 'b58c3ad6ab9d6e3cd425867d64a6766f',indexName: 'rightscale',inputSelector: '#site-search', debug: false, autocompleteOptions: {autoselect: false}});</script></div></div></nav><div class="wrap"><div class="container-fluid max-width"><div class="row"><div class="col-sm-3"><div class="clearfix"><aside class="main-nav" role="complementary"><nav class="list-group" role="navigations"><a class="list-group-item" href="/faq/"><h4 class="list-group-heading"><span>Frequently Asked Questions</span></h4></a><a class="list-group-item" href="/faq/">General</a><a class="list-group-item" href="/faq/clouds/aws">AWS</a><a class="list-group-item" href="/faq/clouds/google">Google Cloud Platform</a><a class="list-group-item" href="/faq/clouds/azure">Microsoft Azure</a><a class="list-group-item" href="/faq/clouds/softlayer">SoftLayer</a><a class="list-group-item" href="/faq/clouds/vmware">VMware</a></nav></aside><div class="callout"><a href="/api/"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../img/icon-api.svg" /><h4>Flexera CMP APIs</h4></div><span>See the API reference documentation for all of our products.</span></div></div></a></div><div class="callout"><a href="../ca/cloud_comp/ca_getting_started_with_cloud_comparison.html"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../img/icon-cloud-blue.svg" /><h4>Cloud Comparison</h4></div><span>Compare public clouds based on the features they offer.</span></div></div></a></div><div class="callout"><a target="_blank" href="http://feedback.rightscale.com"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../img/icon-feedback.svg" /><h4>Feedback</h4></div><span>Get in touch and we’ll get back to you as soon as we can.</span></div></div></a></div><div class="callout"><a href="/release-notes"><div class="panel panel-default"><div class="panel-body"><div class="callout-title"><img src="../img/icon-notes.svg" /><h4>Release Notes</h4></div><span>See the notes for the latest releases of each application and what’s changed.</span></div></div></a></div></div></div><div class="col-sm-9"><div class="row"><div class="col-sm-9"><div class="clearfix"><p><a href="../">Flexera CMP Docs</a> &#x2F; <a href="./">RightScale General FAQs</a></p><div class="page-header"><h1>MySQL Performance Tuning Tips</h1></div><div class="main-content"><h2 id="overview">Overview</h2>

<p>Performance testing is both art and science and finding the right combination of performance parameters needs some trial and error. The easiest tool to use for performance testing is the apache bench load testing tool, referred to as &#39;AB&#39;. This will allow you to quickly simulate load on your servers and test performance changes.</p>

<h2 id="performance-tuning-example">Performance Tuning Example</h2>

<p>For the following we assume you have your deployment all configured and running (Load balancers, array, database, etc) in a simulated production environment:</p>

<p><ol>
  <li>First, you need to determine a baseline of performance with AB only one server in your array and one load balancer. I would disable the array &amp; manually launch 1 array server. This will help establish the number of connections a single web server can handle and simplify the testing process along with easing the debugging process.</p>
<pre class="syntax-highlight plaintext"><code>  ab -n 1000 -c 5 http://yourwebsite.com/index.html &gt;&gt; results.txt
  ab -n 1000 -c 10 http://yourwebsite.com/index.html &gt;&gt; results.txt
  ab -n 1000 -c 50 http://yourwebsite.com/index.html &gt;&gt; results.txt
</code></pre>

<p>This will generate some statistics on how many page requests per second and time per page. Save this information for later reference.</p>

<ul>
<li>Check the monitoring graphs in the RightScale dashboard for information on CPU load especially.</li>
<li>Run these tests with a single array server to see how many connections your application can handle.</li>
<li>You may want to vary the -n <number> -c <number> parameters to suit your needs</li>
</ul>

<p><li>Verify the performance in these areas of your deployments after test #1.</p>

<ul>
<li>Load Balancer performance graphs ( CPU Load ) - should be very low.</li>
<li>MySQL Master Database graphs (transactions per second, cpu load, reads &amp; writes)</li>
<li>Application (web) server graphs (cpu load)</li>
</ul>

<p><li>Verify MySQL Performance</p>

<ul>
<li>Check mysql slow log: (usually) /var/log/mysqlslow.log. You should not have lots of slow queries. Slow queries usually mean poor database indexing.</li>
<li>Check to make sure have added indexes to your tables where possible.</li>
<li>After running your DB for a while download mysqltuner and run the script on the master. It provides valuable advice on MySQL performance.</li>
<li>Some items that usually need adjusting: Maxmimum number of concurrent MySQL connections, Thread_cache_size.</li>
</ul>

<p><li>Check Application Server</p>

<ul>
<li>It is always a good idea to check the http (Apache) logs in /var/logs on the application server</li>
<li>Look for any errors for apache, in /var/log/messages</li>
</ul>

<p><li>Adjustments</p>

<ul>
<li>Start making adjustments based on the results from Apache Bench results, MySQLTuner information &amp; the RightScale monitoring graphs.</li>
<li>This may require some custom tuning of MySQL my.cnf file, the database schema itself, database indexes and/or your web application code itself.</li>
<li>After making changes to the RightScale Inputs, tuning the DB, etc, start the tests over again at Step 1 above.</li>
<li>Look into caching solutions such as: memcached, apc or other caching solutions to improve php &amp; database performance.</li>
</ul>

<p><li>Testing the array and real performance.</p>

<ul>
<li>After you have successfully tuned your deployment with 1 Load Balancer, 1 App Server and the database you can now start testing with a production type environment.</li>
<li>Enable your array &amp; verify the scale_up &amp; scale_down parameters. You may want to set the scale_up threshold to be something simple to start such as <q>cpu.idle < 50 for > 2 minutes</q></li>
<li>Run AB again, this time trying to test the array scaling features. Keep monitoring the graphs to spot any new problems.</li>
<li>After the array scales up, let AB finish and depending on your settings the array should eventually scale back down.</li>
</ul>

<p><li>Final checks</p>

<ul>
<li>Go through the deployment one last time: check mysqlslow &amp; mysql logs, apache logs, all the graphs for your servers.</li>
<li>Re-run MySQLTuner on the Master DB to spot tuning ideas.</li>
<li>Double-check your Deployment Inputs.</li>
<li>Update your Array scale_up &amp; scale_down settings.</li>
<li>Make sure both your Load Balancers are up and running.</li>
<li>Check your DNS entries are pointing to the Load Balancers.</li>
<li>Verify MySQL backups.</li>
<li>Rerun AB to simulate real-world conditions.</li>
<li>Go to Step 1 if problems arise.</li>
</ul>

<p><li>Helpful Links</p>

<ul>
<li>Generic MySQL Tuning: <a href="http://rudd-o.com/en/linux-and-free-software/tuning-a-mysql-server-in-5-minutes">LINK</a></li>
<li>Memcached: <a href="http://www.danga.com/memcached/">LINK</a></li>
</ul>
</div></div></div><div class="col-sm-3 hidden-xs affix-parent"><div class="clearfix" data-clampedwidth=".affix-parent" data-offset-bottom="200" data-offset-top="4" data-spy="affix"><nav class="subnav-right" id="subnav-right" role="sub-nav"><script>createRightHandNav();</script></nav></div></div></div></div></div></div></div><footer class="main-footer" role="contentinfo"><div class="container-fluid max-width"><div class="row"><div class="col-sm-10"><ul class="list-inline"><li><small>&copy; 2024 Flexera</small></li><li><a href="http://www.flexera.com/" target="_blank"><small>Flexera Home</small></a></li><li><a href="https://www.flexera.com/about-us/careers.html" target="_blank"><small>We're Hiring</small></a></li></ul></div></div></div></footer><noscript><iframe height="0" src="//www.googletagmanager.com/ns.html?id=GTM-KB9SMN" style="display:none;visibility:hidden" width="0"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-KB9SMN');</script><script type="text/javascript">
  // Add clipboard button trigger
  var snippets = document.querySelectorAll('.syntax-highlight');
  [].forEach.call(snippets, function(snippet) {
  snippet.firstChild.insertAdjacentHTML('beforebegin', '<button class="btn snippet-clipboard" data-clipboard-snippet><img src="/img/icon-clipboard.svg"></button>');
  });

  // clipboard trigger
  var clipboardSnippets = new Clipboard('[data-clipboard-snippet]', {
  target: function(trigger) {
  return trigger.nextElementSibling;
  }
  });

  // Tooltip trigger
  clipboardSnippets.on('success', function(e) {
  e.clearSelection();
  showTooltip(e.trigger, 'Copied!');
  });

  // Error message
  clipboardSnippets.on('error', function(e) {
  showTooltip(e.trigger, fallbackMessage(e.action));
  });

  // Tooltip events
  var btns = document.querySelectorAll('.syntax-highlight .btn');
  for (var i = 0; i < btns.length; i++) {
  btns[i].addEventListener('mouseleave', clearTooltip);
  btns[i].addEventListener('blur', clearTooltip);
  }

  function clearTooltip(e) {
  e.currentTarget.setAttribute('class', 'btn');
  e.currentTarget.removeAttribute('aria-label');
  }

  function showTooltip(elem, msg) {
  elem.setAttribute('class', 'btn tooltipped tooltipped-s');
  elem.setAttribute('aria-label', msg);
  }
</script></body></html>